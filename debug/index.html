<!DOCTYPE html>
<html>
<head>
    <title>debug page</title>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        #canvas { border: 10px dashed #ccc; }
        #canvas.hover { border: 10px dashed #333; }
    </style>
</head>

<body>
    <script src='geojson-vt-dev.js'></script>
    <canvas id="canvas"></canvas>
    <script>

        var extent = 4096,
            padding = 0.05,
            totalExtent = 4096 * (1 + padding * 2),

            tileIndex,

            canvas = document.getElementById('canvas'),
            ctx = canvas.getContext('2d'),
            height = canvas.height = canvas.width = window.innerHeight - 40,
            ratio = height / totalExtent;

        if (devicePixelRatio > 1) {
            canvas.style.width = canvas.width + 'px';
            canvas.style.height = canvas.height + 'px';
            canvas.width *= 2;
            canvas.height *= 2;
            ctx.scale(2, 2);
        }

        function humanFileSize(size) {
            var i = Math.floor(Math.log(size) / Math.log(1024));
            return Math.round(100 * (size / Math.pow(1024, i))) / 100 + ' ' + ['B', 'kB', 'MB', 'GB'][i];
        };

        canvas.ondragover = function () { this.className = 'hover'; return false; };
        canvas.ondragend = function () { this.className = ''; return false; };
        canvas.ondrop = function (e) {
            this.className = '';

            var reader = new FileReader();
            reader.onload = function (event) {
                console.log('data size', humanFileSize(event.target.result.length));
                console.time('data parsed');
                var data = JSON.parse(event.target.result);
                console.timeEnd('data parsed');

                tileIndex = geojsonvt(data, {
                    maxZoom: 14,
                    debug: 1
                });
            };
            reader.readAsText(e.dataTransfer.files[0]);

            e.preventDefault();
            return false;
        };

    </script>
</body>
</html>
